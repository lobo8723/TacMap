<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tactical Spelling Assist Tool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f0f0f0;
      margin: 0;
      padding: 20px;
    }
    #mainContainer {
      max-width: 900px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.2);
    }
    h1 {
      text-align: center;
      color: #003366;
    }
    textarea {
      width: 100%;
      height: 150px;
      font-size: 16px;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      resize: vertical;
    }
    #buttonPanel {
      margin-top: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }
    .wordBtn {
      padding: 10px 14px;
      background: #006699;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .wordBtn:hover {
      background: #004d73;
    }
  </style>
</head>
<body>
  <div id="mainContainer">
    <h1>Tactical Spelling Assist Tool</h1>
    <textarea id="reportInput" placeholder="Start typing your report here..."></textarea>

    <div id="buttonPanel">
      <button class="wordBtn" onclick="insertWord('suspect')">Suspect</button>
      <button class="wordBtn" onclick="insertWord('vehicle')">Vehicle</button>
      <button class="wordBtn" onclick="insertWord('trespasser')">Trespasser</button>
      <button class="wordBtn" onclick="insertWord('perimeter')">Perimeter</button>
      <button class="wordBtn" onclick="insertWord('complied')">Complied</button>
      <button class="wordBtn" onclick="insertWord('dispatched')">Dispatched</button>
      <button class="wordBtn" onclick="insertWord('observed')">Observed</button>
      <button class="wordBtn" onclick="insertWord('individual')">Individual</button>
      <button class="wordBtn" onclick="insertWord('verbal warning')">Verbal Warning</button>
    </div>
        <hr style="margin: 30px 0;">

    <!-- Phrase Generator -->
    <h3>Quick Phrase Generator</h3>
    <label for="timeSelect">Time:</label>
    <select id="timeSelect">
      <option value="At 2100 hours,">At 2100 hours,</option>
      <option value="At 2300 hours,">At 2300 hours,</option>
      <option value="At 0200 hours,">At 0200 hours,</option>
    </select>

    <label for="actionSelect">Action:</label>
    <select id="actionSelect">
      <option value="the officer observed">the officer observed</option>
      <option value="the officer made contact with">the officer made contact with</option>
      <option value="the officer detained">the officer detained</option>
    </select>

    <label for="subjectSelect">Subject:</label>
    <select id="subjectSelect">
      <option value="a male individual near the rear gate.">a male individual near the rear gate.</option>
      <option value="a suspicious vehicle near the perimeter fence.">a suspicious vehicle near the perimeter fence.</option>
      <option value="a trespasser attempting entry through the east gate.">a trespasser attempting entry through the east gate.</option>
    </select>

    <button onclick="generatePhrase()" class="wordBtn" style="margin-top: 10px;">Insert Phrase</button>

    <!-- Drag-and-Drop Sentence Builder -->
    <h3 style="margin-top: 30px;">Sentence Builder (Drag & Drop)</h3>
    <div id="sentencePool" style="display: flex; gap: 10px; flex-wrap: wrap;">
      <div class="draggableBox" draggable="true">Officer observed</div>
      <div class="draggableBox" draggable="true">Suspicious individual</div>
      <div class="draggableBox" draggable="true">Near rear gate</div>
      <div class="draggableBox" draggable="true">Issued verbal warning</div>
      <div class="draggableBox" draggable="true">Contacted dispatch</div>
    </div>

    <div id="dropZone" ondrop="drop(event)" ondragover="allowDrop(event)" style="margin-top: 20px; padding: 20px; border: 2px dashed #ccc; border-radius: 8px; min-height: 80px;">
      <strong>Drop phrases here to build sentence.</strong>
    </div>
        <style>
      .draggableBox {
        background: #e0e0e0;
        padding: 8px 12px;
        border-radius: 6px;
        cursor: move;
      }

      #dropZone .draggableBox {
        background: #cce5ff;
        margin: 5px 0;
      }

      #cantSpellMode {
        margin-top: 30px;
        background: #ffcc00;
        border: none;
        color: #333;
        padding: 10px 14px;
        font-weight: bold;
        border-radius: 6px;
        cursor: pointer;
      }

      #suggestions {
        margin-top: 15px;
        padding: 10px;
        background: #f8f8f8;
        border: 1px solid #ccc;
        border-radius: 6px;
        display: none;
      }
    </style>

    <button id="cantSpellMode" onclick="toggleCantSpell()">Activate ‘I Can’t Spell’ Mode</button>
    <div id="suggestions"></div>

    <script>
      function insertWord(word) {
        let textarea = document.getElementById('reportInput');
        textarea.value += (textarea.value.trim().length ? ' ' : '') + word;
        textarea.focus();
      }

      function generatePhrase() {
        let phrase = document.getElementById('timeSelect').value + ' ' +
                     document.getElementById('actionSelect').value + ' ' +
                     document.getElementById('subjectSelect').value;
        insertWord(phrase);
      }

      function allowDrop(ev) {
        ev.preventDefault();
      }

      function drop(ev) {
        ev.preventDefault();
        const data = ev.dataTransfer.getData("text");
        const newElem = document.createElement("div");
        newElem.className = "draggableBox";
        newElem.textContent = data;
        document.getElementById("dropZone").appendChild(newElem);
        insertWord(data);
      }

      document.querySelectorAll(".draggableBox").forEach(box => {
        box.addEventListener("dragstart", e => {
          e.dataTransfer.setData("text", e.target.textContent);
        });
      });
            const dictionary = ["suspect", "vehicle", "trespasser", "perimeter", "complied", "dispatch", "observed", "individual", "warning", "suspicious", "security"];

      function soundex(s) {
        s = s.toLowerCase().replace(/[^a-z]/g, '');
        if (!s) return "";
        const a = s.split('');
        const f = a.shift();
        const codes = { a:'', e:'', i:'', o:'', u:'', h:'', w:'', y:'', b:'1', f:'1', p:'1', v:'1', c:'2', g:'2', j:'2', k:'2', q:'2', s:'2', x:'2', z:'2', d:'3', t:'3', l:'4', m:'5', n:'5', r:'6' };
        const mapped = a.map(letter => codes[letter]);
        const filtered = mapped.filter((code, i) => code !== mapped[i - 1]).join('');
        return (f + filtered + '000').slice(0, 4).toUpperCase();
      }

      let cantSpell = false;

      function toggleCantSpell() {
        cantSpell = !cantSpell;
        document.getElementById("cantSpellMode").innerText = cantSpell ? "‘I Can’t Spell’ Mode: ON" : "Activate ‘I Can’t Spell’ Mode";
        document.getElementById("suggestions").style.display = cantSpell ? "block" : "none";
      }

      document.getElementById("reportInput").addEventListener("input", function() {
        if (!cantSpell) return;
        const words = this.value.split(/\s+/);
        const lastWord = words[words.length - 1].toLowerCase();
        const userSoundex = soundex(lastWord);
        const matches = dictionary.filter(w => soundex(w) === userSoundex);
        showSuggestions(matches, lastWord);
      });

      function showSuggestions(matches, input) {
        const div = document.getElementById("suggestions");
        if (matches.length === 0) {
          div.innerHTML = `<em>No suggestions for "${input}"</em>`;
        } else {
          div.innerHTML = "<strong>Did you mean:</strong><br>" + matches.map(m => `<button onclick="replaceLastWord('${m}')">${m}</button>`).join(" ");
        }
      }

      function replaceLastWord(word) {
        let textarea = document.getElementById("reportInput");
        let text = textarea.value.trim().split(/\s+/);
        text[text.length - 1] = word;
        textarea.value = text.join(" ");
        textarea.focus();
      }
    </script>
        <hr style="margin: 30px 0;">
    <h3>Pronounce a Word</h3>
    <input type="text" id="speakWord" placeholder="Type word to hear..." style="width: 60%; padding: 8px;">
    <button onclick="speakIt()" class="wordBtn">Speak</button>

    <script>
      function speakIt() {
        const word = document.getElementById("speakWord").value;
        const msg = new SpeechSynthesisUtterance(word);
        window.speechSynthesis.speak(msg);
      }
    </script>

    <hr style="margin: 30px 0;">
    <h3>Basic Grammar Hints</h3>
    <p>Words with repeated spaces, no punctuation, or lowercase sentence starts will be underlined in red.</p>
    <script>
      document.getElementById("reportInput").addEventListener("input", function() {
        const text = this.value;
        this.style.borderColor = (text.includes("  ") || !/[.!?]$/.test(text.trim())) ? "red" : "#ccc";
      });
    </script>
  </div>
</body>
</html>